

@{ ViewBag.Title = "Home Page"; }

@model TestWebApp.Models.UserViewModel
@{ Layout = null; }

<script src="~/Scripts/jquery-3.5.0.min.js"></script>
<script src="~/Scripts/bootstrap.min.js"></script>
<link href="~/Content/bootstrap.min.css" rel="stylesheet" />


<div class="container" style="margin-top:3%">
    <a href="#" class="btn btn-info" onclick="AddNewUser(0)">Add New User</a><br /><br />

    <table class="table table-striped">
        <thead>
            <tr>
                <th>Id</th>
                <th>Name</th>
                <th>Date Modified</th>
                <th>Is Active</th>
            </tr>
        </thead>
        <tbody id="SetUserList">
            <tr id="LoadingStatus" style="color:red"></tr>
        </tbody>
    </table>

    @* Modal pop up to add user *@
    <div class="modal fade" id=" myModal">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <a href="#" class="close" data-dismiss="modal">&times;</a>
                    <h4 id="ModalTitle"></h4>
                </div>
                <div class="modal-body">
                    <form id="form">
                        <fieldset id="SubmitForm">
                            @Html.HiddenFor(m => m.Id, new { @id = "Id" })
                            <div class="form-group">
                                @Html.TextBoxFor(m => m.Name, new { @id = "Name", @class = "form-control", @placeholder = "Name*" })
                            </div>
                            <div class="form-group">
                                @Html.TextBoxFor(m => m.DateModified, new { @id = "UserDateModified", @class = "form-control", @placeholder = "DateModified*" })
                            </div>
                            <div class="form-group">
                                @Html.TextBoxFor(m => m.IsActive, new { @id = "UserIsActive", @class = "form-control", @placeholder = "IsActive*" })
                            </div>
                            <div class="form-group">
                                <a href="#" class="btn btn-block btn-danger" id="SaveUserRecord">Save</a>
                            </div>

                        </fieldset>
                    </form>

                </div>
            </div>

        </div>

    </div>


</div>

@* To display fibonacci sequence *@
<br />
<br />
<br />
<div style="margin:20px;">

    <br /><br />
    <input type="button" value="Show" id="show_button" />
    <br /><br />
    <div id="updating_div">Result</div>

</div>


@* jquery and ajax to display user list *@
<script>
    $("#LoadingStatus").html("Loading...");
    $.get("/Home/GetUserList", null, DataBind);
    function DataBind(UserList) {
        var SetData = $("#SetUserList");
        for (var i = 0; i < UserList.length; i++) {
            var Data = "<tr class='row_" + UserList[i].Id + "'>" +
                "<td>" + UserList[i].Id + "</td>" +
                "<td>" + UserList[i].Name + "</td>" +
                "<td>" + UserList[i].DateModified + "</td>" +
                "<td>" + UserList[i].IsActive + "</td>" +
                "<tr>";
            SetData.append(Data);
            $("#LoadingStatus").html("");

        }
    }

    //Show the modal pop up to add user

    function AddNewUser(Id) {
        $("#form")[0].reset();
        $("#ModalTitle").html("Add New User");
        $("#myModal").modal();

    }
    //save user record
    $("#SaveUserRecord").click(function () {
        var data = $("#submitForm").serialize();
        $.ajax({
            type: "Post",
            url: "/Home/SaveDataInDatabase",
            data: data,
            success: function (result) {
                alert("Success");
                window.location.href = "/Home/Index";
                $("#MyModal").modal("hide");

            }
        });
    });

    //Fibonacci sequence
    $(document).ready(function () {
        $("#show_button").click(function () {
            $.ajax({
                type: "POST",
                url: "/Home/FibonacciSeq",
                success: function (series) {
                    $("#updating_div").html("Result: " + series);
                }
            });
        });
        alert("check");
    });
</script>